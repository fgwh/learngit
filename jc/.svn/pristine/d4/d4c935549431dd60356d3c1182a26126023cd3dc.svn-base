<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping>
    <class name="com.hgsoft.security.entity.OperLog" table="TB_OperLog" >
        <id name="id" type="java.lang.String">
            <column name="id" />
            <generator class="uuid"></generator>
        </id>
        <many-to-one name="admin" class="com.hgsoft.security.entity.Admin" fetch="select">
            <column name="operId" />
        </many-to-one>
        <property name="operType" type="java.lang.String">
            <column name="operType" />
        </property>
        <property name="moduleId" type="java.lang.String">
            <column name="moduleId" />
        </property>
        <property name="details" type="java.lang.String">
            <column name="details" length="400" />
        </property>
        <property name="operTime" type="java.util.Date">
            <column name="operTime" length="23" />
        </property>
        <property name="ip" type="java.lang.String">
            <column name="ip" length="20" />
        </property>
        <property name="remark" type="java.lang.String">
            <column name="remark" length="200" />
        </property>
         <property name="orgId" type="java.lang.String">
            <column name="orgId" length="200" />
        </property>
    </class>
     <sql-query name="queryOperLogSql">
		select ol.id,ol.operType,ol.moduleId,m.name moduleName,ol.details,ol.operId,a.name adminName,ol.operTime,ol.ip,ol.remark
		from tb_operLog ol left join sys_module m on ol.moduleId=m.id left join sys_admin a on ol.operId=a.id  left join sys_org g on g.id=ol.orgId where 1=1
		and (''=:moduleName or m.name like :moduleName)  and (''=:staffNo or a.staffNo=:staffNo) 
		and (''=:startQueryDate or CONVERT(varchar(100),ol.operTime,23)>=:startQueryDate)
		and (''=:endQueryDate or :endQueryDate >=CONVERT(varchar(100),ol.operTime,23)) 
		and (''=:operLogType or ol.operType=:operLogType) 
		and g.treeCode like :treeCode
		order by ol.operTime desc
    </sql-query>
</hibernate-mapping>
